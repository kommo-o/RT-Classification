By the time the surprise ending is revealed