A flawed but engrossing thriller