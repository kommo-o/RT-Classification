before it builds up to its insanely staged ballroom scene , in which 3000 actors appear in full regalia